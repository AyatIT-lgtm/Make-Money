<!--
File: telegram-make-money-webapp.html
Description: Telegram Mini App with Integrated Rewarded Ads (libtl.com SDK).
-->

<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Make Money ‚Äî Telegram Mini App</title>
  <meta name="description" content="Make Money Telegram Mini App ‚Äî Monetize, referrals, payouts." />
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  <style>
    /* Styles */
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#06b6d4}
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;background:linear-gradient(180deg,#071025 0%, #071430 60%);color:#e6eef6}
    .wrap{max-width:980px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;gap:16px}
    h1{margin:0;font-size:20px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:16px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.6)}
    .grid{display:grid;gap:12px}
    .two{grid-template-columns:1fr 360px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input,select,button,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .list{display:flex;flex-direction:column;gap:8px}
    .small{font-size:13px;color:var(--muted)}
    .ad-slot{min-height:90px;border:1px dashed rgba(255,255,255,0.06);display:flex;align-items:center;justify-content:center;border-radius:8px}
    footer{margin-top:18px;color:var(--muted);font-size:13px}
    .row{display:flex;gap:8px;align-items:center}
    .btn{background:linear-gradient(90deg,var(--accent),#60a5fa);border:none;color:#012;font-weight:600;padding:10px 12px;border-radius:10px;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
    .settings{display:flex;flex-direction:column;gap:8px}
    pre{background:#031324;padding:10px;border-radius:8px;overflow:auto}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="card" style="padding:12px 14px;display:flex;align-items:center;gap:12px">
        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40'><rect rx='8' ry='8' width='40' height='40' fill='%2306b6d4'/><text x='50%' y='55%' font-size='18' text-anchor='middle' fill='white' font-family='Arial'>MM</text></svg>" alt="logo" style="width:44px;height:44px;border-radius:10px"/>
        <div>
          <h1>Make Money ‚Äî Telegram Mini App</h1>
          <div class="small">Telegram Web App ready ‚Ä¢ Watch Ads & Earn</div>
        </div>
      </div>
    </header>

    <main style="margin-top:14px" class="grid two">
      <section class="card">
        <h2 style="margin:0 0 8px 0">User panel</h2>
        <div class="small" id="tg-status">Initializing Telegram Web App...</div>

        <div style="margin-top:12px" class="grid">
          <div>
            <label>User Info</label>
            <div class="row" style="gap:12px">
              <div style="flex:1">
                <input id="user-name" placeholder="User Name" readonly />
                <div class="small">User ID: <span id="user-id">‚Äî</span></div>
              </div>
            </div>
          </div>

          <div>
            <label>Balance & Earnings</label>
            <div style="display:flex;gap:8px;align-items:center">
              <div style="flex:1">
                <div class="small" style="font-size:16px; color:#fff;">Balance: <span id="balance">0.00</span> USD</div>
              </div>
              <div style="width:120px"><button class="btn" id="withdraw">Withdraw</button></div>
            </div>
          </div>

          <div>
            <label>Earning Tasks</label>
            <div style="display:flex;gap:8px; flex-direction:column;">
              <!-- This button now triggers the SDK -->
              <button class="btn" id="task-ad" style="padding:15px;">üì∫ Watch Rewarded Ad (+0.10$)</button>
              
              <button class="btn ghost" id="task-link">Open Offer Link</button>
            </div>
            <div class="small" style="margin-top:6px">‡¶¨‡¶ø‡¶É‡¶¶‡ßç‡¶∞‡¶É ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶¨‡ßá‡•§</div>
          </div>
          
          <div>
             <label>Ad Status</label>
             <div id="ad-status" class="small">Ready to load ads.</div>
          </div>
        </div>
      </section>

      <aside class="card">
        <h3 style="margin-top:0">Settings / Payout</h3>
        <div class="settings">
          <label>Payout Method</label>
          <select id="payout-method">
            <option value="bkash">bKash</option>
            <option value="nagad">Nagad</option>
            <option value="binance">Binance</option>
          </select>

          <button class="btn" id="save-settings">Save Payout Details</button>
          <button class="btn ghost" id="reset-demo">Reset Balance</button>
        </div>
      </aside>
    </main>

    <section style="margin-top:14px" class="card">
      <footer>
        Admin Note: This app uses libtl.com SDK for monetization. Ensure strict compliance with ad network policies.
      </footer>
    </section>

  </div>

  <!-- Telegram Web App JS -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- YOUR NEW SDK SCRIPT ADDED HERE -->
  <script src='//libtl.com/sdk.js' data-zone='10253960' data-sdk='show_10253960'></script>

  <script>
    // --- App Logic ---
    const tg = window.Telegram ? window.Telegram.WebApp : null;
    const userNameEl = document.getElementById('user-name');
    const userIdEl = document.getElementById('user-id');
    const tgStatus = document.getElementById('tg-status');
    const balanceEl = document.getElementById('balance');
    const adStatus = document.getElementById('ad-status');

    let state = { 
        userId: null, 
        balance: parseFloat(localStorage.getItem('mm_balance')) || 0 
    };

    function initTelegram(){
      if(!tg){ tgStatus.textContent = 'Opening in Browser Mode (Test)'; }
      else {
        tg.expand();
        tgStatus.textContent = 'Running inside Telegram';
        const user = tg.initDataUnsafe?.user || {};
        state.userId = user.id || 'guest';
        userNameEl.value = user.first_name || 'Guest User';
        userIdEl.textContent = state.userId;
      }
      renderBalance();
    }

    function renderBalance(){ 
        balanceEl.textContent = parseFloat(state.balance).toFixed(2);
        localStorage.setItem('mm_balance', state.balance);
    }

    function creditUser(amount, reason){
      state.balance = +(state.balance||0) + Number(amount);
      renderBalance();
      adStatus.textContent = `Success! Credited $${amount} for ${reason}.`;
      adStatus.style.color = '#4ade80'; // Green
      
      // Optional: Send to server
      // fetch('/webhook/claim', { method:'POST', body: JSON.stringify({userId: state.userId, amount}) });
    }

    // --- INTEGRATED AD LOGIC ---
    document.getElementById('task-ad').addEventListener('click', () => {
        adStatus.textContent = "Loading Ad...";
        adStatus.style.color = '#9aa4b2';

        // Check if SDK function exists
        if (typeof show_10253960 === 'function') {
            
            show_10253960('pop').then(() => {
                // SUCCESS: User watched the ad or interacted
                console.log('Ad finished/closed successfully');
                
                // Reward the user
                creditUser(0.10, 'Watching Ad'); 
                
                if(tg) tg.HapticFeedback.notificationOccurred('success');
                alert('Congratulations! You earned $0.10');

            }).catch(e => {
                // ERROR: Something went wrong
                console.error('Ad Error:', e);
                adStatus.textContent = "Error loading ad. Try again.";
                adStatus.style.color = '#ff4d6d'; // Red
            });

        } else {
            adStatus.textContent = "Ad SDK not loaded. Check internet connection or AdBlock.";
            alert("Ad SDK not ready yet. Please wait a moment.");
        }
    });

    // Other Buttons
    document.getElementById('task-link').addEventListener('click', ()=>{
      window.open('https://google.com', '_blank');
      creditUser(0.01, 'Link Click');
    });

    document.getElementById('withdraw').addEventListener('click', ()=>{
      if(state.balance < 5) {
        alert('Minimum withdraw is $5.00');
      } else {
        alert(`Withdraw request for $${state.balance} sent!`);
        state.balance = 0;
        renderBalance();
      }
    });

    document.getElementById('reset-demo').addEventListener('click', ()=>{
        if(confirm("Reset balance?")) {
            state.balance = 0; 
            renderBalance();
        }
    });

    // Start
    initTelegram();
  </script>
</body>
</html>
